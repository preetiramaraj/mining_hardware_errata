from gensim.models.word2vec import Word2Vec
import matplotlib.pyplot as plt
from sklearn.manifold import TSNE
import numpy as np

model_det = Word2Vec.load('Cortex_Failure_workaround.model')
# Top 250 words
#keywords = ['mode', 'bit', 'data', 'x', 'set', 'clock', 'reset', 'register', 'memory', 'l', 'c', 'workaround', 'read', 'software', 'write', 'value', 'issue', 'cache', 'interrupt', 'usb', 'must', 'power', 'device', 'use', 'processor', 'case', 'dma', 'may', 'error', 'access', 'address', 'channel', 'operation', 'state', 'used', 'erratum', 'following', 'control', 'one', 'enable', 'omap', 'fifo', 'status', 'projected','time', 'module', 'core', 'system', 'two', 'bits', 'using', 'line', 'arm', 'conditions', 'silicon', 'enabled', 'port', 'request', 'disable', 'registers', 'transfer', 'b', 'h', 'boot', 'setting', 'p', 'sequence', 'clk', 'code', 'due', 'dsi', 'occurs', 'phy', 'host', 'external', 'revision', 'instruction', 'frame', 'mode.', 'first', 'nfc', 'dispc', 'internal', 'signal', 'non', 'cannot', 'idle', 'f', 'low', 'voltage', 'r', 'applications', 'result', 'occur', 'field', 'load', 'configuration', 'controller', 'counter', 'accesses', 'revised', 'incorporated', 'instruments', 'copyright', 'texas', 'bus', 'high', 'tx', 'buffer', 'emif', 'back', 'configured', 'size', 'might', 'october', 'block', 'documentation', 'feedback', 'submit', 'done', 'secure', 'burst', 'warm', 'sprz', 'glitch', 'event', 'february', 'command', 'd', 'link', 'disabled', 'behavior', 'also', 'dpll', 'rx', 'hs', 'cause', 'id', 'rom', 'table', 'slave', 'impact', 'ulpi', 'wait', 'err', 'refresh', 'condition', 'pll', 'page', 'region', 'change', 'm', 'number', 'possible', 'gfx', 'ddr', 'suspend', 'tll', 'global', 'generated', 'frequency', 'ahb', 'gpio', 'instead', 'second', 'ctrl', 'avoid', 'always', 'interface', 'cm', 'maintenance', 'active', 'video', 'pad', 'wakeup', 'work', 'ns', 'feature', 'required', 'resume', 'i.mx', 'next', 'nand', 'example', 'even', 'bytes', 'packet', 'speed', 'output', 'wake', 'timer', 'domain', 'store', 'sw', 'register.', 'cpu', 'lpddr', 'chip', 'source', 'input', 'perform', 'functional', 'program', 'start', 'incorrect', 'master', 'clean', 'performance', 'v', 'note', 'en', 'written', 'cacheable', 'transition', 'default', 'mpu', 'new', 'operations', 'clear', 'timing', 'www.ti.com', 'engcm', 'hardware', 'protocol', 'ensure', 'last', 'wrong', 'debug', 'entry', 'received', 'update', 'ocp', 'level', 'period', 'engine', 'less', 'lp', 'instructions', 'sent', 'follows', 'supported', 'expected', 'cycle', 'performed', 'logic', 'programmed', 'ready']

# Top 500 words
keywords=['mode', 'bit', 'data', 'x', 'set', 'clock', 'reset', 'register', 'memory', 'l', 'c', 'workaround', 'read', 'software', 'write', 'value', 'issue', 'cache', 'interrupt', 'usb', 'must', 'power', 'device', 'use', 'processor', 'case', 'dma', 'may', 'error', 'access', 'address', 'channel', 'operation', 'state', 'used', 'erratum', 'following', 'control', 'one', 'enable', 'omap', 'fifo', 'status', 'projected','time', 'module', 'core', 'system', 'two', 'bits', 'using', 'line', 'arm', 'conditions', 'silicon', 'enabled', 'port', 'request', 'disable', 'registers', 'transfer', 'b', 'h', 'boot', 'setting', 'p', 'sequence', 'clk', 'code', 'due', 'dsi', 'occurs', 'phy', 'host', 'external', 'revision', 'instruction', 'frame', 'mode.', 'first', 'nfc', 'dispc', 'internal', 'signal', 'non', 'cannot', 'idle', 'f', 'low', 'voltage', 'r', 'applications', 'result', 'occur', 'field', 'load', 'configuration', 'controller', 'counter', 'accesses', 'revised', 'incorporated', 'instruments', 'copyright', 'texas', 'bus', 'high', 'tx', 'buffer', 'emif', 'back', 'configured', 'size', 'might', 'october', 'block', 'documentation', 'feedback', 'submit', 'done', 'secure', 'burst', 'warm', 'sprz', 'glitch', 'event', 'february', 'command', 'd', 'link', 'disabled', 'behavior', 'also', 'dpll', 'rx', 'hs', 'cause', 'id', 'rom', 'table', 'slave', 'impact', 'ulpi', 'wait', 'err', 'refresh', 'condition', 'pll', 'page', 'region', 'change', 'm', 'number', 'possible', 'gfx', 'ddr', 'suspend', 'tll', 'global', 'generated', 'frequency', 'ahb', 'gpio', 'instead', 'second', 'ctrl', 'avoid', 'always', 'interface', 'cm', 'maintenance', 'active', 'video', 'pad', 'wakeup', 'work', 'ns', 'feature', 'required', 'resume', 'i.mx', 'next', 'nand', 'example', 'even', 'bytes', 'packet', 'speed', 'output', 'wake', 'timer', 'domain', 'store', 'sw', 'register.', 'cpu', 'lpddr', 'chip', 'source', 'input', 'perform', 'functional', 'program', 'start', 'incorrect', 'master', 'clean', 'performance', 'v', 'note', 'en', 'written', 'cacheable', 'transition', 'default', 'mpu', 'new', 'operations', 'clear', 'timing', 'engcm', 'hardware', 'protocol', 'ensure', 'last', 'wrong', 'debug', 'entry', 'received', 'update', 'ocp', 'level', 'period', 'engine', 'less', 'lp', 'instructions', 'sent', 'follows', 'supported', 'expected', 'cycle', 'performed', 'logic', 'programmed', 'ready', 'user', 'pixel', 'otg', 'end', 'ram', 'reported', 'overflow', 'different', 'devices', 'scenario', 'valid', 'io', 'vdd', 'mmc', 'bug', 'hsr', 'therefore', 'sync', 'reset.', 'another', 'switch', 'corruption', 'lock', 'normal', 'none', 'sdma', 're', 'transaction', 'type', 'check', 'prcm', 'generate', 'single', 'length', 'cycles', 'sata', 'without', 'sd', 'mechanism', 'mva', 'executed', 'automatic', 'pipeline', 'support', 'full', 'config', 'cleared', 'current', 'watchdog', 'reg', 'pcie', 'values', 'spi', 'causes', 'mcpdm', 'self', 'abort', 'card', 'mipi', 'either', 'correctly', 'writing', 'limitation', 'still', 'loop', 'requires', 'axi', 'correct', 'multiple', 'errors', 'e', 'connected', 'make', 'deadlock', 'irq', 'iva', 'send', 'transmission', 'upon', 'alpha', 'supply', 'bit.', 'incorrectly', 'never', 'mcr', 'zero', 'exclusive', 'impacted', 'available', 'problem', 'ordered', 'stop', 'transfers', 'state.', 'delay', 'happen', 'auto', 'configure', 'root', 'save', 'threshold', 'uart', 'lines', 'specific', 'cortex', 'design', 'dsp', 'section', 'issue.', 'response', 'hsi', 'issues', 'could', 'failure', 'step', 'causing', 'o', 'descriptor', 'interrupts', 'esdhc', 'posted', 'cp', 'neon', 'equal', 'path', 'image', 'count', 'described', 'reads', 'implemented', 'setup',  'hang', 'freq', 'need', 'allocate', 'packets', 'byte', 'mhz', 'counters']
print len(keywords)
vectors =[model_det[word] for word in keywords]
tsne = TSNE(n_components=2,random_state=0)
vectors2d = tsne.fit_transform(np.asfarray(vectors, dtype='float'))
for point, word in zip(vectors2d, keywords):
    plt.scatter(point[0], point[1])
    plt.annotate(word,
                 xy = (point[0], point[1]),
                 size='x-large')
plt.show()

